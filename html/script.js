var date=new Date;let prevbtn=document.querySelectorAll(".prev__btn"),needdate=document.querySelector(".date__end__inp"),pincode=document.querySelector(".team__pin__inp");var curr=document.querySelector(".date__start__inp");let reason=document.querySelector(".reason__leave__inp"),submit=document.querySelector(".__submit"),btn=document.querySelectorAll(".btn__name"),nameinp=document.querySelector(".name__inp"),state,globalCounter=0,loader=document.querySelector(".pre-container"),loadertxt=document.querySelector(".inner-loader>span"),spinner=document.querySelector(".spin");function checkInp(event){let status=!0,validate;(()=>{(""==nameinp.value||null==nameinp.value)&&(status=!1),(""==curr.value||null==curr.value)&&(status=!1),(""==needdate.value||null==needdate.value)&&(status=!1),(""==pincode.value||null==pincode.value)&&(status=!1),(""==reason.value||null==reason.value)&&(status=!1)})(),status?(loader.style.display="block",formSubmit()):alert("Fill All fields")}labels={DateofEnd:`When will you come back Mr/Mrs.${nameinp.value.toUpperCase()}?`,Datebegins:"Did the Leave \n    Starts from the below date?.if not change it",teampin:"Enter your team pincode with student code eg:teampin-code",end:"Your Almost there enter your reason"},document.addEventListener("DOMContentLoaded",()=>{if(date.getMonth()+1<=9&&date.getDate()<=9){let temp=date.getFullYear()+"-0"+(date.getMonth()+1)+"-0"+date.getDate();curr.value=temp}else{let temp=date.getFullYear()+"-0"+(date.getMonth()+1)+"-"+date.getDate();curr.value=temp}}),submit.addEventListener("click",checkInp);let counter=0,methodsOrder=[()=>{InitAnimation("label__end","DateofEnd"," &#128543;",document.querySelector(".date__end"))},()=>InitAnimation("label__start","Datebegins","",document.querySelector(".date__start")),()=>InitAnimation("label__team__pin","teampin","",document.querySelector(".team__pin")),()=>InitAnimation("label__reason__leave","end","",document.querySelector(".reason__leave"))];function InitAnimation(target,type,reference="",container){let counter=0;container.style.display="block",container.previousSibling.previousSibling.style.display="none",state=container;let source=document.querySelector("."+target);source.textContent="","DateofEnd"==type&&(labels={DateofEnd:`When will you come back Mr/Mrs.${nameinp.value.toUpperCase()}?`,Datebegins:"Did the Leave \n    Starts from the below date?.if not change it",teampin:"Enter your team pincode with student code eg:teampin-code",end:"Your Almost there enter your reason"});let temp=setInterval(()=>{counter<labels[type].length?(source.textContent+=`${labels[type].charAt(counter)}`,counter++):(reference&&(source.innerHTML+=reference),clearInterval(temp))},50)}async function formSubmit(){let data={name:nameinp.value,dateofEnd:needdate.value,dataofstart:curr.value,teampin:pincode.value,reason:reason.value},formData,state=!1;if((new FormData).append("name",nameinp.value),window.fetch){let resf=await fetch("/server",{headers:{"Content-Type":"application/json"},method:"POST",body:`${JSON.stringify(data)}`}).then(e=>{if(200==e.status)return e.blob();throw new Error("Request denied by server")}).then(e=>{loadertxt.textContent="Submitted sucessfully ",spinner.style.display="none",window.open(URL.createObjectURL(e),"","width=500,height=500")}).catch(e=>{loadertxt.textContent="An error occured! check the entered data/network or contact query@acsind.tech",spinner.style.display="none"})}else{let xmlhttp=new XMLHttpRequest;xmlhttp.onreadystatechange=function(){if(2==this.readyState&&(this.responseType="blob"),4==this.readyState&&200==this.status){loadertxt.textContent="Submitted sucessfully ",spinner.style.display="none";let pdf=new Blob([this.response],{type:"application/pdf"});window.open(URL.createObjectURL(pdf),"","width=500,height=500")}},xmlhttp.onerror=e=>{loadertxt.textContent="An error occured! check the entered data/network or contact query@acsind.tech",spinner.style.display="none"},xmlhttp.open("POST","/server"),xmlhttp.setRequestHeader("Content-Type","application/json"),xmlhttp.send(`${JSON.stringify(data)}`)}}btn.forEach((value,index)=>{value.addEventListener("click",e=>{state&&(state.style.display="none"),counter<4&&(methodsOrder[counter](),counter++)})}),prevbtn.forEach(value=>{value.addEventListener("click",e=>{0!=counter&&(state.style.display="none",state.previousSibling.previousSibling.style.display="block",state=state.previousSibling.previousSibling)})});